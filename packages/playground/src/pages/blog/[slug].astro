---
import { getCollection } from 'astro:content';
import DocLayout from '../../components/DocLayout.astro';

export async function getStaticPaths() {
	const posts = await getCollection('blog');
	return posts.map(entry => ({
		params: { slug: entry.slug },
		props: { entry },
	}));
}

const { entry } = Astro.props;
const { Content } = await entry.render();
const { title, author, date, tags, coverImage } = entry.data;
---

<DocLayout title={title} description={entry.data.excerpt}>
	<article class="mx-auto max-w-3xl px-6 py-16">
		<a href="/blog/" class="text-sm text-slate-500 hover:text-slate-300 transition-colors">&larr; All posts</a>

		<header class="mt-6">
			<div class="flex flex-wrap items-center gap-2 text-sm text-slate-500">
				<time datetime={date.toISOString().slice(0, 10)}>
					{date.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}
				</time>
				<span>&middot;</span>
				<span>{author}</span>
			</div>
			<h1 class="mt-3 text-4xl font-bold tracking-tight text-white">{title}</h1>
			<div class="mt-4 flex flex-wrap gap-2">
				{tags.map(tag => (
					<span class="rounded-full border border-slate-700 bg-slate-800/50 px-3 py-1 text-xs text-slate-400">
						{tag}
					</span>
				))}
			</div>
		</header>

		<img
			src={coverImage}
			alt={title}
			class="mt-8 w-full rounded-xl object-cover"
		/>

		<div class="prose prose-invert prose-slate mt-10 max-w-none prose-headings:font-semibold prose-a:text-indigo-300 prose-a:no-underline hover:prose-a:underline">
			<Content />
		</div>
	</article>
</DocLayout>

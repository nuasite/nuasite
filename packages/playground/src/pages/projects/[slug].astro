---
import { getCollection } from 'astro:content';
import DocLayout from '../../components/DocLayout.astro';

export async function getStaticPaths() {
	const projects = await getCollection('projects');
	return projects.map(entry => ({
		params: { slug: entry.slug },
		props: { entry },
	}));
}

const { entry } = Astro.props;
const { Content } = await entry.render();
const { title, client, date, tags, coverImage, url } = entry.data;
---

<DocLayout title={`${title} — ${client}`} description={`${title} — part of the ${client} package.`}>
	<article class="mx-auto max-w-3xl px-6 py-16">
		<a href="/projects/" class="text-sm text-slate-500 hover:text-slate-300 transition-colors">&larr; All projects</a>

		<header class="mt-6">
			<p class="text-sm text-slate-500">{client}</p>
			<h1 class="mt-1 text-4xl font-bold tracking-tight text-white">{title}</h1>
			<div class="mt-4 flex flex-wrap items-center gap-3">
				<time datetime={date.toISOString().slice(0, 10)} class="text-xs text-slate-500">
					{date.toLocaleDateString('en-US', { year: 'numeric', month: 'long' })}
				</time>
				{tags.map(tag => (
					<span class="rounded-full border border-slate-700 bg-slate-800/50 px-2.5 py-0.5 text-xs text-slate-400">
						{tag}
					</span>
				))}
			</div>
		</header>

		<img
			src={coverImage}
			alt={title}
			class="mt-8 w-full rounded-xl object-cover"
		/>

		{url && (
			<div class="mt-6">
				<a href={url} target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-1.5 rounded-lg border border-slate-700 bg-slate-800/50 px-4 py-2 text-sm text-slate-300 transition hover:border-slate-600 hover:text-white">
					Visit live site &rarr;
				</a>
			</div>
		)}

		<div class="prose prose-invert prose-slate mt-10 max-w-none prose-headings:font-semibold prose-a:text-indigo-300 prose-a:no-underline hover:prose-a:underline">
			<Content />
		</div>
	</article>
</DocLayout>
